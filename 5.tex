\section{Jeffreys Priors.}

\begin{align*}
    g(\theta) &\propto \sqrt{I(\theta)}\\
    I(\theta) &= \left< \left[\frac{\d}{\d\theta} \ln(L(x|\theta))\right]^2 \right> = \int dx L(x|\theta) \left[\frac{\d}{\d\theta} \ln(L(x|\theta))\right]^2\\
\end{align*}

\begin{enumerate}[label=\textbf{\Alph*}.]
    \item Consider a measurement in which we flip a single coin once, and want to estimate the probability $p$ for the coin coming up heads. Derive the Jeffreys prior $g(p)$ in this case.

    Use the formula, where the likelihood of each hypothesis is $L(\text{head}|p) = p, L(\text{tail}|p) = 1-p$. Let's define a head to have value $x=0$ and tail value $x=1$, so then we can write $L(x|p)$ as a sum of delta functions, $L(x|p) = \delta(x-0)p + \delta(x-1)(1-p)$.

    \begin{align*}
        \frac{\d}{\d p} \ln(L(x|p)) &= \frac{\d}{\d p} \ln(\delta(x-0)p + \delta(x-1)(1-p)) \\
        &= \frac{\d}{\d p} \ln(\delta(x-0)p + \delta(x-1)(1-p)) \\
        &= \frac{\d}{\d p} \ln((\delta(x-0) - \delta(x-1))p + \delta(x-1)) \\
        &= \frac{\delta(x-0) - \delta(x-1)}{(\delta(x-0) - \delta(x-1))p + \delta(x-1)} \\
    \end{align*}
    \begin{align*}
        I(p) &= \int dx L(x|p) \left[\frac{\d}{\d p} \ln(L(x|p))\right]^2\\
        &= \int dx [\delta(x-0)p + \delta(x-1)(1-p)] \left[\frac{\delta(x-0) - \delta(x-1)}{(\delta(x-0) - \delta(x-1))p + \delta(x-1)}\right]^2\\
        &= \int dx \frac{\left[\delta(x-0) - \delta(x-1)\right]^2}{(\delta(x-0) - \delta(x-1))p + \delta(x-1)}\\
        &= \frac{1}{p} + \frac{1}{1-p}\\
        &= \frac{1}{p(1-p)}\\
        g(p) &\propto \frac{1}{\sqrt{p(1-p)}} \\
    \end{align*}

    Find the constant of proportionality by normalizing:
    \begin{align*}
        \int_0^1 g(p)dp &= 1 \\
        \int_0^1 A \frac{1}{\sqrt{p(1-p)}} dp &= 1 \\
        A \pi &= 1 \\
        A &= \frac{1}{\pi} \\
    \end{align*}

    \begin{align*}
        g(p) &= \frac{1}{\pi\sqrt{p(1-p)}} \\
    \end{align*}

    \item Suppose that you start with this prior, then flip the coin three times, yielding three heads. What is the probability that $p<0.5$?
    
    Prior: $g(p) = \frac{1}{\pi\sqrt{p(1-p)}}$

    Likelihood: $P(\text{3 heads}|p) = \prod_i=1^3 P(\text{heads}|p) = p^3$

    Probability of data:
    \begin{align*}
        P(\text{3 heads}) &= \int P(p) P(\text{3 heads}|p) dp \\
        &= \int \frac{1}{\pi\sqrt{p(1-p)}} p^3 dp \\
        &= \int_0^1 \frac{p^3}{\pi\sqrt{p(1-p)}} dp \\
        &= \frac{5}{16} \\
    \end{align*}

    Bayes's Theorem:
    \begin{align*}
        P(p|\text{3 heads}) &= \frac{P(p)P(\text{3 heads}|p)}{P(\text{3 heads})} \\
        &= \frac{\frac{1}{\pi\sqrt{p(1-p)}} p^3 }{\frac{5}{16}} \\
        &= \frac{16p^3}{5\pi\sqrt{p(1-p)}} \\
    \end{align*}

    So the probability that $p<0.5$ is
    \begin{align*}
        P &= \int_0^{0.5} P(p|\text{3 heads}) dp \\
        &= \int_0^{0.5} \frac{16p^3}{5\pi\sqrt{p(1-p)}} dp \\
        &= \frac{15\pi - 44}{30\pi} \\
        &\approx 0.033 \\
    \end{align*}

\end{enumerate}

\todo[inline]{finish me!}
